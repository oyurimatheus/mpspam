
window.MENU_SNSP = {};
(function(document) {
	'use strict';

	function init() {
		var divMenu = document.createElement('div'),
			divPadding = document.createElement('div'),
			cssMenu = document.createElement('link'),
			cssOther = document.createElement('link'),
			cssAnimate = document.createElement('link'),
			cssSimpleGrid = document.createElement('link'),
			iframe = createJsIFrame(),
			ambiente = 'pro',
			rootUrl = 'https://seguranca.sinesp.gov.br/sinesp-menu/',
			buildNumber = '03-12-2018 16:23',
			segurancaUrl = 'https://seguranca.sinesp.gov.br/sinesp-seguranca',
			menuUrl = 'https://seguranca.sinesp.gov.br/sinesp-menu',
			baseUrl = 'https://seguranca.sinesp.gov.br';

		MENU_SNSP.URLS = {
			seguranca: segurancaUrl,
			layout: rootUrl + 'layout.html?v=' + buildNumber,
			dadosUsuario: segurancaUrl + '/services/menu/consultarDadosUsuario',
			dadosMenu: segurancaUrl + '/services/menu/consultarDadosMenu',
			configMenu: segurancaUrl + '/services/menu/consultarConfigMenu',
			consultarDadosUsuarioCompleto: segurancaUrl + '/services/menu/consultarDadosAlteracaoUsuario',
			consultarDadosDeAutenticacao: segurancaUrl + '/services/menu/consultarDadosDeAutenticacao',
			validaSenha: segurancaUrl + '/services/menu/validarSenhaAlteracaoDadosCadastrais',
			alterarDadosUsuario: segurancaUrl + '/services/menu/alterarDadosUsuario',
			consultarMunicipios: segurancaUrl + '/services/menu/consultarMunicipios',
			carregaFoto: menuUrl + '/foto/carrega',
			tempoSessao: segurancaUrl + '/services/menu/consultarTempoInatividade',
			atualizarSessaoUsuario: segurancaUrl + '/services/menu/atualizarSessaoUsuario',
			consultarPerfisUsuario: segurancaUrl + '/services/menu/consultarPerfisUsuario',
			logout: segurancaUrl + '/logout',
			initEsperaLigacao: segurancaUrl + '/services/menu/marcarInicioEsperaLigacao',
			verificarLigacaoTelefonica: segurancaUrl + '/services/menu/verificarLigacaoTelefonica',
			solicitarAlteracaoDadosAut: segurancaUrl + '/services/menu/solicitarAlteracaoDadosSeguranca',
			exibirAbaGestores: segurancaUrl + '/services/menu/exibirAbaGestores',
			atualizarAbaAppsMoveis: segurancaUrl + '/services/menu/atualizarAbaAppsMoveis',
			historicoInstalacoesAppMovel: segurancaUrl + '/services/menu/historicoInstalacoesAppMovel',
			consultarApps: segurancaUrl + '/services/menu/consultarAplicativosMoveis'
		};
		
		MENU_SNSP.PARAMS = {
			ambiente: ambiente,
			telSegFator: '(61) 3241-2700 ou (61) 3241-2900',
			urlRootMenu: menuUrl
		};
		
	    //Criando o div do Menu e o div de Padding para empurrar a pagina do sistema cliente para baixo
		divMenu.setAttribute('id', 'menu_sinesp');
		divMenu.setAttribute('class', 'cabecalho-unico-sinesp');
		divMenu.setAttribute('style', 'position: absolute; top: 0; left: 0; border-bottom-width: 1px; width: 100%;');
		divPadding.setAttribute('id', 'menu_sinesp_pad');
		divPadding.setAttribute('style', 'height: 52px');

		document.body.insertBefore(divPadding, document.body.childNodes[0] || null);
		document.body.insertBefore(divMenu, document.body.childNodes[0] || null);
		document.body.insertBefore(iframe, document.body.childNodes[0] || null);

		// Style do Menu
		cssMenu.rel = 'stylesheet';
		cssMenu.type = 'text/css';
		cssMenu.href = rootUrl + 'css/main.css?v=' + buildNumber;
		document.head.appendChild(cssMenu);
		
		iframe.contentWindow.document.write('<body></body>');
		
		// Bibliotecas de terceiros 
		iframe.contentWindow.document.write('<script src="' + rootUrl + 'js/lib/xdomain.js" data-debug="false"></script>');
		iframe.contentWindow.document.write('<script>xdomain.slaves({"' + segurancaUrl + '": "/proxy.html" , "'+menuUrl+'" : "/proxy.html", "'+baseUrl+'" : "/sinesp-menu/proxy.html"});</script>');
		iframe.contentWindow.document.write('<script src="' + rootUrl + 'js/lib/jquery.min.js" type="text/javascript"></script>');
		iframe.contentWindow.document.write('<script src="' + rootUrl + 'js/lib/jquery.colorbox.js" type="text/javascript"></script>');
		iframe.contentWindow.document.write('<script src="' + rootUrl + 'js/lib/jquery.mask.min.js" type="text/javascript"></script>');
		iframe.contentWindow.document.write('<script src="' + rootUrl + 'js/lib/jquery.countdown.min.js" type="text/javascript"></script>');
		iframe.contentWindow.document.write('<script src="' + rootUrl + 'js/lib/toastr.min.js" type="text/javascript"></script>');
		iframe.contentWindow.document.write('<script src="' + rootUrl + 'js/lib/spin.min.js" type="text/javascript"></script>');
		iframe.contentWindow.document.write('<script src="' + rootUrl + 'js/lib/jquery.spin.js" type="text/javascript"></script>');
		iframe.contentWindow.document.write('<script src="' + rootUrl + 'js/lib/jquery.easyModal.js" type="text/javascript"></script>');
		
		// Javascripts do Menu
		iframe.contentWindow.document.write('<script src="' + rootUrl + 'js/main.js?v=' + buildNumber + '" type="text/javascript"></script>');

		cssOther.rel = 'stylesheet';
		cssOther.type = 'text/css';
		cssOther.href = rootUrl + 'css/colorbox.css';
		document.head.appendChild(cssOther);
		
		cssAnimate.rel = 'stylesheet';
		cssAnimate.type = 'text/css';
		cssAnimate.href = rootUrl + 'css/toastr.min.css';
		document.head.appendChild(cssAnimate);
		
		cssSimpleGrid.rel = 'stylesheet';
		cssSimpleGrid.type = 'text/css';
		cssSimpleGrid.href = rootUrl + 'css/simplegrid.css';
		document.head.appendChild(cssSimpleGrid);
		
		//Feito para evitar o icone de loading infinito do firefox.
		iframe.contentWindow.document.close();
	}

	function createJsIFrame() {
		var iframe = document.createElement('iframe');

		iframe.setAttribute('id', 'main_js_iframe');
		iframe.setAttribute('style', 'width: 0; height: 0; position:absolute;');
		iframe.setAttribute('marginheight', '0');
		iframe.setAttribute('marginwidth', '0');
		iframe.setAttribute('tabindex', '0');
		iframe.setAttribute('frameborder', '0');
		iframe.setAttribute('hspace', '0');
		iframe.setAttribute('vspace', '0');

		return iframe;
	}

	function onload(f) {
		function exec() {
			(/^loaded|^i|^c/.test(document.readyState)) ? f() : setTimeout(exec, 10);
		}
		exec();
	}

	(document.addEventListener) ? document.addEventListener('DOMContentLoaded', init) : onload(init);

})(window.document);