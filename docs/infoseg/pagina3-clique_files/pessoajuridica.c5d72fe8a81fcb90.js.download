var PessoaJuridica={listarFiltro:function(a,e,o,i){var t=[];if(!0===a.success){if(Filtro.limparListagemConteudo(i),null!=a.payload&&0<a.payload.length){$("#"+i).data("registros",a.payload);for(var r=$("#"+i+"-nomeEmpresarial").val(),s=$("#"+i+"-cnpj").val(),n=$("#"+i+"-nomeFantasia").val(),l=$("#"+i+"-naturezaJuridica").val(),c=$("#"+i+"-dataInicioAtividade").val(),d=$("#"+i+"-cpfResponsavel").val(),u=$("#"+i+"-motivoSituacaoCadastral").val(),p=document.getElementById(i+"-uf"),f=0<p.selectedIndex?p.options[p.selectedIndex].value:"",m=0;m<a.payload.length;m++)Filtro.filtrarString(r,a.payload[m].nomeEmpresarial)&&Filtro.filtrarString(s,formatarCnpj(a.payload[m].cnpj))&&Filtro.filtrarString(n,a.payload[m].nomeFantasia)&&Filtro.filtrarString(l,a.payload[m].naturezaJuridica)&&Filtro.filtrarString(c,a.payload[m].dataInicioAtividade)&&Filtro.filtrarString(d,formatarCpf(a.payload[m].cpfResponsavel))&&Filtro.filtrarString(u,a.payload[m].situacaoCadastral)&&Filtro.filtrarString(f,a.payload[m].uf)&&t.push(a.payload[m]);0<t.length&&Filtro.paginarRegistrosFiltrados(i,10,t,PessoaJuridica.gerarDadosBasicos),Report.showOrHideCheckboxAll(i)}Filtro.mostrarMensagemFiltro(i,a.msgRetorno,t.length)}else Filtro.mostrarMensagemFiltroInsucesso(i,a.msgRetorno)},consultarListaOk:function(a,e,o,i,t,r,s){Funcoes.consoleLogResult("PessoaJuridica.consultarListaOk",a,e,o);var n=document.getElementById(i+"-lista-conteudo");if(null===n?(criarEstruturaListagemResultados(i),n=document.getElementById(i+"-lista-conteudo")):$(n).empty(),!0===a.success){if(null!=a.payload&&0<a.payload.length){for(var l=0;l<a.payload.length;l++){var c=i+"-"+l;PessoaJuridica.gerarDadosBasicos(n,a.payload[l],c,!1)}if(r){$("#"+i).data("parameters",t);10<a.totalRegistros&&Filtro.gerarBotaoDeFiltro(i,PessoaJuridica.gerarFormularioDeFiltro,COD_SERVICO.SRV_PESSOAJURIDICA,a.totalRegistros),Counters.counterAdd(i,COD_SERVICO.SRV_PESSOAJURIDICA,a.totalRegistros),paginarListagemResultados(i,t,a.totalRegistros,s,PessoaJuridica.consultarListaOk,10)}Report.showOrHideCheckboxAll(i)}}else gerarMensagemInsucesso(n,a.msgRetorno)},consultarOk:function(a,e,o,i){var t=document.createElement("div");if(t.setAttribute("id",i+"-lista-conteudo"),t.setAttribute("class","list collapse in"),$("#"+i).append(t),!0===a.success){if(null!=a.payload){var r=i+"-0";PessoaJuridica.gerarDadosBasicos(t,a.payload,r,!0),PessoaJuridica.gerarDadosDetalhes(t,a.payload,r),Counters.counterInc(i,COD_SERVICO.SRV_PESSOAJURIDICA)}}else gerarMensagemInsucesso(t,a.msgRetorno)},consultarDetalhesOk:function(a,e,o,i){var t=document.getElementById(i),r=$(t).parent();!0===a.success?null!=a.payload&&(PessoaJuridica.gerarDadosDetalhes(r,a.payload,i),$(t).find(".row:eq(0)").find("div").first().find("p").off("click"),$(t).find(".row:eq(0)").find("div").first().find("p").on("click",function(){util.popOverSubEl(t.id,t.id+"-detalhe")}),util.popOverSubEl(i,i+"-detalhe")):gerarMensagemInsucesso(t,a.msgRetorno)},gerarDadosBasicos:function(a,e,o,i){var t=document.createElement("div");t.setAttribute("id",o),Report.checkbox(t,formatarCnpj(e.cnpj),COD_SERVICO.SRV_PESSOAJURIDICA,e);var r=PessoaJuridica.dadosBasicos(e,!1);$(t).append(r),$(a).append(t),i?$(t).find(".row:eq(0)").find("div").first().find("p").on("click",function(){util.popOverSubEl(t.id,t.id+"-detalhe")}):$(t).find(".row:eq(0)").find("div").first().find("p").one("click",function(){PessoaJuridica.realizarBuscaDetalhes(e.cnpj,t)})},gerarDadosDetalhes:function(a,e,o){var i=document.createElement("div");i.setAttribute("id",o+"-detalhe"),i.setAttribute("hidden",""),i.setAttribute("title","Pessoa Jurídica"),Report.checkboxDetails(i,formatarCnpj(e.cnpj),COD_SERVICO.SRV_PESSOAJURIDICA,e);var t=PessoaJuridica.dadosDetalhe(e,!1),r="tab-"+o+"-detalhe",s="tab-"+o+"-socios",n="tab-"+o+"-sucessao",l='<div><ul id="ul-tab-det-'+o+'" class="nav nav-tabs"><li class="active"><a data-toggle="tab" href="#'+r+'">Detalhes da Pessoa Jurídica</a></li><li><a data-toggle="tab" href="#'+s+'">Quadro Societário</a></li><li><a data-toggle="tab" href="#'+n+'">Sucedidas e Sucessoras</a></li></ul><div id="ul-tab-det-content-'+o+'" class="tab-content"><div id="'+r+'" class="tab-pane fade in active">'+t+'</div><div id="'+s+'" class="tab-pane fade in"></div><div id="'+n+'" class="tab-pane fade in"></div></div></div>';$(i).append(l),$(a).append(i),$('a[href="#'+s+'"]').one("click",function(){PessoaJuridica.realizarBuscaSocios(e.cnpj,s)}),$('a[href="#'+n+'"]').one("click",function(){PessoaJuridica.realizarBuscaSucessao(e.cnpj,n)})},dadosBasicos:function(a,e){return linhaResult("4","Nome Empresarial",NI(a.nomeEmpresarial),"","2","Número de Inscrição",e?formatarCnpj(a.cnpj):Funcoes.link(formatarCnpj(a.cnpj)),"","6","Nome Fantasia",NI(a.nomeFantasia),"","4","Natureza Jurídica",NI(a.naturezaJuridica),"","2","Data Início Atividade",NI(a.dataInicioAtividade),"","2","CPF Responsável",e?formatarCpf(a.cpfResponsavel):Funcoes.link(formatarCpf(a.cpfResponsavel)),"","1","UF",NI(a.uf),"","2","Situação Cadastral",NI(a.situacaoCadastral),"")},dadosDetalhe:function(a,e){var o=e?colunasResult("4","Nome Empresarial",NI(a.nomeEmpresarial),""):"";o+=colunasResult("4","CNPJ",e?formatarCnpj(a.cnpj):Funcoes.link(formatarCnpj(a.cnpj)),"","4","Nome Fantasia",NI(a.nomeFantasia),"","4","Natureza Jurídica",NI(a.naturezaJuridica),"","4","Data Início Atividade",NI(a.dataInicioAtividade),"","4","UF",NI(a.uf),"","4","Situação Cadastral",NI(a.situacaoCadastral),"","4","Matriz/Filial",NI(a.matrizFilial),"","4","Data da Situação Cadastral",NI(a.dataSituacaoCadastral),""),null!=a.paisExterior&&""!==a.paisExterior.trim()&&(o+=colunasResult("4","Cidade no Exterior",NI(a.municipioExterior)+" - "+NI(a.paisExterior))),o+=colunasResult("4","CNAE Principal",NI(a.cnaeFiscal),"","4","CNAE Secundária",NI(a.cnaeSecundario01),""),0<a.codigoCnaeSecundario02&&(o+=colunasResult("4","CNAE Secundária",NI(a.cnaeSecundario02),"")),0<a.codigoCnaeSecundario03&&(o+=colunasResult("4","CNAE Secundária",NI(a.cnaeSecundario03),"")),0<a.codigoCnaeSecundario04&&(o+=colunasResult("4","CNAE Secundária",NI(a.cnaeSecundario04),"")),0<a.codigoCnaeSecundario05&&(o+=colunasResult("4","CNAE Secundária",NI(a.cnaeSecundario05),"")),0<a.codigoCnaeSecundario06&&(o+=colunasResult("4","CNAE Secundária",NI(a.cnaeSecundario06),"")),0<a.codigoCnaeSecundario07&&(o+=colunasResult("4","CNAE Secundária",NI(a.cnaeSecundario07),"")),0<a.codigoCnaeSecundario08&&(o+=colunasResult("4","CNAE Secundária",NI(a.cnaeSecundario08),"")),0<a.codigoCnaeSecundario09&&(o+=colunasResult("4","CNAE Secundária",NI(a.cnaeSecundario09),"")),0<a.codigoCnaeSecundario10&&(o+=colunasResult("4","CNAE Secundária",NI(a.cnaeSecundario10),""));var i=(NuloOuVazio(a.tipoLogradouro)?"":a.tipoLogradouro+" ")+(NuloOuVazio(a.logradouro)?"":a.logradouro+" ")+(NuloOuVazio(a.numero)?"":a.numero+" ")+(NuloOuVazio(a.complemento)?"":", "+a.complemento),t=Funcoes.formatarTelefone(a.ddd1,a.telefone1),r=Funcoes.formatarTelefone(a.ddd2,a.telefone2),s=Funcoes.formatarTelefone(a.dddFax,a.telefoneFax);return o+=colunasResult("4","Endereço",NI(i),"","4","Bairro",NI(a.bairro),"","4","Município",NI(a.municipio),"","4","CEP",Funcoes.formatarCep(a.cep),"","4","Telefone",t,"","4","Telefone 2",r,"","4","Email",NI(a.correioEletronico),"","4","CPF Responsável",e?formatarCpf(a.cpfResponsavel):Funcoes.link(formatarCpf(a.cpfResponsavel)),"","4","Nome Responsável",NI(a.nomeResponsavel),"","4","Capital social da empresa",NI(a.capitalSocial),"","4","Porte do Estabelecimento",NI(a.porteEmpresa),"","4","Opção pelo Simples Nacional",NI(a.opcaoSimples),"","4","Motivo Situação Cadastral",NI(a.motivoSituacaoCadastral),"","4","Fax",s,"","4","Qualificação Responsável",NI(a.qualificacaoResponsavel),"","4","Data Opção Simples",NI(a.dataOpcaoSimples),""),o=resultDiv(o)+PessoaJuridica.dadosContador(a.contador)},dadosContador:function(a){var e="";return'<div class="list reportDetails"><h4>Dados do Contador</h4>'+(e+=null!=a?linhaResult("4","F"==a.indContadorPfPj?"CPF do Contador":"CNPJ do Contador","F"==a.indContadorPfPj?formatarCpf(a.cpfCnpjContador):formatarCnpj(a.cpfCnpjContador),"","4","Nome do contador",NI(a.nomeContador),"","4","Número do CRC do contador",NI(a.crcContador),"","4","Tipo do CRC do contador",NI(a.tipoCrcContador),"","4","Classificação do CRC do contador",NI(a.descricaoClassificacaoCrc),"","4","UF CRC Contador",NI(a.ufRegistro),""):"<span>N/I</span>")+"</div>"},reportItem:function(a,e,o){var i=document.createElement("div");i.setAttribute("id",o);var t=PessoaJuridica.dadosBasicos(e,!0);$(i).append(t),$(a).append(i),$(i).find(".row:eq(0)").find("div").first().find("p").on("click",function(){PessoaJuridica.realizarBuscaDetalhesParaAdicionarNoRelatorio(e.cnpj,i)})},reportItemDetalhe:function(a,e,o){var i=document.createElement("div");i.setAttribute("id",o);var t=PessoaJuridica.dadosDetalhe(e,!0);if(t=resultDiv(t),$(i).append(t),null!=e.socios&&0<e.socios.length){var r=document.createElement("div");r.setAttribute("class","list reportDetails"),$(r).append("<h5>Quadro Societário</h5>");for(var s=0;s<e.socios.length;s++){var n=o+"-"+s;PessoaJuridica.gerarDadosSocio(r,e.socios[s],n)}$(i).append(r)}if(null!=e.sucessoes&&0<e.sucessoes.length){var l=document.createElement("div");l.setAttribute("class","list reportDetails"),$(l).append("<h5>Sucedidas e Sucessoras</h5>");for(s=0;s<e.sucessoes.length;s++){n=o+"-"+s;PessoaJuridica.gerarDadosSucessao(l,e.sucessoes[s],n)}$(i).append(l)}$(a).append(i)},realizarBuscaDetalhes:function(a,e){var o={cnpj:a};genericRequest(PessoaJuridicaProxy.getPessoaJuridica,o,PessoaJuridica.consultarDetalhesOk,e.id)},realizarBuscaDetalhesParaAdicionarNoRelatorio:function(e,o){util.confirm("Confirma a inclusão do detalhamento do item no relatório?").done(function(){var a={cnpj:formatarCnpj(e)};genericRequest(PessoaJuridicaProxy.getPessoaJuridica,a,PessoaJuridica.consultarDetalhesParaAdicionarNoRelatorioOk,o.id)}).fail()},consultarDetalhesParaAdicionarNoRelatorioOk:function(a,e,o,i){var t=document.getElementById(i);!0===a.success?null!=a.payload&&($(t).find(".row:eq(0)").find("div").first().find("p").off("click"),t.setAttribute("data-servico",COD_SERVICO.SRV_PESSOAJURIDICA),t.setAttribute("data-key",formatarCnpj(a.payload.cnpj)),t.setAttribute("data-tipo","R"),t.setAttribute("data-parent-id",i),$(t).data("payload",a.payload),Report.addItemReport(t)):gerarMensagemInsucesso(t,a.msgRetorno)},realizarBuscaSocios:function(a,e){var o={cnpj:a,registroInicial:1,registroFinal:4};genericRequest(PessoaJuridicaProxy.getSocios,o,PessoaJuridica.consultarSociosOk,e,!0)},realizarBuscaSucessao:function(a,e){var o={cnpj:a,registroInicial:1,registroFinal:4};genericRequest(PessoaJuridicaProxy.getSucessao,o,PessoaJuridica.consultarSucessaoOk,e,!0)},consultarSociosOk:function(a,e,o,i,t,r){var s=null;if(!0===r){(s=document.createElement("div")).setAttribute("id",i+"-lista"),s.setAttribute("class","list"),$("#tab-"+i).off("click");var n=document.getElementById(i);n.setAttribute("href","#"+i+"-lista"),n.appendChild(s)}else s=document.getElementById(i),$(s).empty();if(!0===a.success){if(null!=a.payload&&0<a.payload.length)for(var l=0;l<a.payload.length;l++){var c=i+"-"+l;PessoaJuridica.gerarDadosSocio(s,a.payload[l],c)}}else gerarMensagemInsucesso(s,a.msgRetorno);$("#result").off("click","#tab-"+i),r&&paginarResultados(s.id,t,a.totalRegistros,PessoaJuridicaProxy.getSocios,PessoaJuridica.consultarSociosOk,4)},consultarSucessaoOk:function(a,e,o,i,t,r){var s=null;if(!0===r){(s=document.createElement("div")).setAttribute("id",i+"-lista"),s.setAttribute("class","list"),$("#tab-"+i).off("click");var n=document.getElementById(i);n.setAttribute("href","#"+i+"-lista"),n.appendChild(s)}else s=document.getElementById(i),$(s).empty();if(!0===a.success){if(null!=a.payload&&0<a.payload.length)for(var l=0;l<a.payload.length;l++){var c=i+"-"+l;PessoaJuridica.gerarDadosSucessao(s,a.payload[l],c)}}else gerarMensagemInsucesso(s,a.msgRetorno);$("#result").off("click","#tab-"+i),r&&paginarResultados(s.id,t,a.totalRegistros,PessoaJuridicaProxy.getSucessao,PessoaJuridica.consultarSucessaoOk,4)},gerarDadosSocio:function(a,e,o){var i=document.createElement("div");i.setAttribute("id",o);var t=linhaResult("2","CPF/CNPJ",e.cpfCnpj,"","4","Nome do Sócio",e.nome,"","4","Qualificação do Sócio",NI(e.qualificacao),"","2","Capital Sócio",e.percentualCapitalSocial,"");t+=linhaResult("2","CPF Repr. do Sócio",NI(e.cpfRepresentanteLegal),"","4","Nome Representante do Sócio",NI(e.representanteLegal),"","4","Qualificação do Repr. Legal do Sócio",NI(e.qualificacaoRepresentanteLegal),"","2","País",NI(e.paisExterior),""),$(i).append(t),$(a).append(i)},gerarDadosSucessao:function(a,e,o){var i=document.createElement("div");i.setAttribute("id",o);var t=colunasResult("4","Data da Operação de Sucessão",NI(e.dataEventoSucessora),"","8","Operação de Sucessão",NI(e.operacaoSucessao),""),r=colunasResult("2","CNPJ Sucedida",formatarCnpj(e.cnpjSucedida),"","5","Nome Empresarial Sucedida",NI(e.nomeEmpresarialSucedida),"","2","UF Sucedida",NI(e.ufSucedida),"","3","CPF Responsável Sucedida",formatarCpf(e.cpfResponsavelSucedida),""),s=colunasResult("2","CNPJ Sucessora",formatarCnpj(e.cnpjSucessora),"","5","Nome Empresarial Sucessora",NI(e.nomeEmpresarialSucessora),"","2","UF Sucessora",NI(e.ufSucessora),"","3","CPF Responsável Sucessora",formatarCpf(e.cpfResponsavelSucessora),""),n=resultDiv(t)+resultDiv(r)+resultDiv(s);$(i).append(n),$(a).append(i)},gerarFormularioDeFiltro:function(a,e){$(e).off("click");var o=$("<div class='sinesp-dropdown-menu sinesp-popover text-left'><form id='frm-"+a+"' class='form frm-filtro-pessoajuridica' novalidate><input type='hidden' value='"+a+"' name='chave'/><div class='row sinesp-filter-row-small'><div class='col-md-12'><div class='form-group'><label>Nome Empresarial</label><input type='text' class='form-control' id='"+a+"-nomeEmpresarial' maxlength='100' /></div><div class='form-group'><label>Número de Inscrição</label><input type='text' class='form-control' id='"+a+"-cnpj' maxlength='14'  onkeypress='return Funcoes.isNumeroDigitado(event)'/></div><div class='form-group'><label>Nome Fantasia</label><input type='text' class='form-control' id='"+a+"-nomeFantasia' maxlength='100' /></div><div class='form-group'><label>Natureza Jurídica</label><input type='text' class='form-control' id='"+a+"-naturezaJuridica' maxlength='100' /></div><div class='form-group'><label>Data Início Atividade</label><input type='text' class='form-control' id='"+a+"-dataInicioAtividade' maxlength='10'  onkeypress='return Funcoes.isDataDigitada(event)'/></div><div class='form-group'><label>CPF Responsável</label><input type='text' class='form-control' id='"+a+"-cpfResponsavel' maxlength='11'  onkeypress='return Funcoes.isNumeroDigitado(event)'/></div><div class='form-group'><label>UF</label><select class='form-control' id='"+a+"-uf'>"+Funcoes.carregarListaUfs()+"</select></div><div class='form-group'><label>Situação Cadastral</label><input type='text' class='form-control' id='"+a+"-motivoSituacaoCadastral' maxlength='100' /></div><div class='form-group text-right'><button id='"+a+"-btn-limpar-formulario' class='btn btn-primary' type='button'  onclick='Filtro.limparFormulario(this.form)'>Limpar</span></button>&nbsp;&nbsp;&nbsp;<button id='"+a+"-btn-filtrar-pesquisa' type='submit' class='btn btn-primary' >Filtrar &nbsp; <span class='glyphicon glyphicon-search'></span></button></div></div></div></form></div>");$("#"+a+"-lista-filtro").append(o)}};$(function(){$("body").on("submit",".frm-filtro-pessoajuridica",function(a){Filtro.tratarSubmit(a,this,PessoaJuridicaProxy.getListaPessoaJuridicaFiltro,PessoaJuridica.listarFiltro)})});