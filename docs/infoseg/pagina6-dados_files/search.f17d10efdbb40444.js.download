var searchConfig={showTypes:!1,doSearch:!0,debug:!1},TIPO_PARAMETRO={TYPE_PLACA:"Placa",TYPE_AERONAVE:"Prefixo Aeronave",TYPE_CPF:"CPF",TYPE_CNPJ:"CNPJ",TYPE_ALPHA:"Nome",TYPE_NUMERIC:"Número",TYPE_ALPHANUMERIC:"Alfanumérico",TYPE_CHASSI:"Chassi",TYPE_MANDADO:"Número Mandado",TYPE_PROCESSO:"Número Processo",TYPE_EMPRESA:"Empresa",TYPE_SINARM:"SINARM",TYPE_RENACH:"RENACH",TYPE_MAE:"Mãe",TYPE_PAI:"Pai",TYPE_DATA:"Data"},COD_SERVICO={SRV_ARMAS:"SRV_ARMAS",SRV_VEICULOS:"SRV_VEICULOS",SRV_MANDADOS:"SRV_MANDADOS",SRV_CONDUTORES:"SRV_CONDUTORES",SRV_PESSOAFISICA:"SRV_PESSOAFISICA",SRV_PESSOAJURIDICA:"SRV_PESSOAJURIDICA",SRV_INDICE_NACIONAL:"SRV_INDICE_NACIONAL",SRV_INTERPOL:"SRV_INTERPOL",SRV_DESAPARECIDOS:"SRV_DESAPARECIDOS",SRV_SIAPEN:"SRV_SIAPEN",SRV_RAIS_ESTAB:"SRV_RAIS_ESTAB",SRV_RAIS_TRAB:"SRV_RAIS_TRAB",SRV_BOS:"SRV_BOS",SRV_SISME_ARMAS:"SRV_SISME_ARMAS",SRV_SISME_PESSOAS:"SRV_SISME_PESSOAS",SRV_SISME_VEICULOS:"SRV_SISME_VEICULOS"},NOME_SERVICO={SRV_ARMAS:"DPF - SINARM",SRV_VEICULOS:"Denatran - RENAVAM",SRV_MANDADOS:"CNJ - BNMP",SRV_CONDUTORES:"Denatran - RENACH",SRV_PESSOAFISICA:"Receita Federal - PF",SRV_PESSOAJURIDICA:"Receita Federal - PJ",SRV_INDICE_NACIONAL:"Índice Nacional",SRV_INTERPOL:"Interpol",SRV_DESAPARECIDOS:"Desaparecidos",SRV_SIAPEN:"DEPEN - SIAPEN",SRV_RAIS_ESTAB:"MTE - RAIS Estabelecimento",SRV_RAIS_TRAB:"MTE - RAIS Trabalhador",SRV_BOS:"Sinesp – Integração BO",SRV_SISME_ARMAS:"SISME - Armas",SRV_SISME_PESSOAS:"SISME - Pessoas",SRV_SISME_VEICULOS:"SISME - Veículos"},SUB_TIPO_SERVICO={MR_DETALHAMENTO:"MD",MR_PROCEDIMENTOS:"MP",MR_MOV_PENITENCIARIAS:"MM",MR_PROCESSOS:"MR",SIAPEN_ADVOGADOS:"SA",SIAPEN_VISITANTES:"SP",SIAPEN_VISITAS:"SV",SIAPEN_TRANSFERENCIAS:"ST",RAIS_TRAB_VINCULADOS:"RV",CAGED_MOV_ESTABELECIMENTO:"CE",CAGED_MOV_TRABALHADOR:"CT"};function setProperty(e,a){if(""!=a){if("true"==a)return!0;if("false"==a)return!1}return e}function getUrlParameterByName(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null==a?"":decodeURIComponent(a[1].replace(/\+/g," "))}function consultarServicos(e){var a=0,s="",r=!0;if(e.result){Counters.enableCounters(e),0<e.result.length&&($("#result").show(),$("#resultTabs").show());for(var o=0;o<e.result.length;o++){var i,n,t,c=e.result[o];switch(n="p"+a,s!=c.arg&&(r?r=!1:n="p"+ ++a,$("#result").append('<div id="'+n+"\"><h3><a class='sinesp-collapse-control' data-toggle='collapse' href='#"+n+"-content'><span class='icon-set icon-minus'></span><span class=\"label_c\">"+TIPO_PARAMETRO[c.type]+"</span><span>"+Funcoes.htmlEncode(c.arg)+'</span><span class="label_v" id="cnt-sec-'+n+"\">0</span></a></h3><div id='"+n+"-content' class='collapse in'></div></div>"),s=c.arg,Counters.paramCounters(n)),Counters.paramServiceCounter(n,c.service),t=n+"-content",n=n+"-"+c.service,$("#"+t).append('<div id="'+n+'"><h4><a href="#'+n+'-lista" data-toggle="collapse" class="sinesp-collapse-control"><span class="icon-set icon-minus"></span>'+NOME_SERVICO[c.service]+"</a></h4></div>"),c.type){case"TYPE_PLACA":i={placa:c.arg},genericRequest(VeiculosProxy.getVeiculoPorPlaca,i,Veiculos.listar,n,!0);break;case"TYPE_CHASSI":i={chassi:c.arg},genericRequest(VeiculosProxy.getVeiculoPorChassi,i,Veiculos.listar,n,!0);break;case"TYPE_ALPHA":switch(c.service){case COD_SERVICO.SRV_MANDADOS:i={nome:c.arg,registroInicial:1,registroFinal:10},c.quoted&&(i.pesquisaExata=!0),genericRequest(MandadosProxy.getMandados,i,Mandados.consultarLista,n,!0);break;case COD_SERVICO.SRV_PESSOAFISICA:i={nome:c.arg,registroInicial:1,registroFinal:10},c.quoted&&(i.tipoPesquisa="EXATA"),genericRequest(PessoaFisicaProxy.getListaPessoaFisica,i,consultarListaPessoaFisicaOk,n,!0);break;case COD_SERVICO.SRV_INDICE_NACIONAL:i={nome:c.arg,indice:0,tamanhoPagina:10},c.quoted&&(i.consultaExata="true"),genericRequest(IndividuosProxy.getIndividuos,i,Individuos.consultarIndividuosOk,n,!0);break;case COD_SERVICO.SRV_INTERPOL:i={nome:c.arg},genericRequest(InterpolProxy.getPessoas,i,Interpol.consultarInterpolOk,n,!0);break;case COD_SERVICO.SRV_DESAPARECIDOS:i={registroInicial:1,registroFinal:10},c.quoted?i.nome=c.arg:i.nomeFonetico=c.arg,genericRequest(DesaparecidosProxy.getDesaparecidos,i,Desaparecidos.consultarDesaparecidosOk,n,!0);break;case COD_SERVICO.SRV_SIAPEN:i={nome:c.arg,registroInicial:1,registroFinal:10},c.quoted&&(i.tipoPesquisa="EXATA"),genericRequest(SiapenProxy.getInternos,i,Siapen.consultarInternosOk,n,!0);break;case COD_SERVICO.SRV_RAIS_TRAB:i={nome:c.arg},c.quoted&&(i.tipoPesquisa="EXATA"),genericRequest(RaisProxy.getTrabalhadores,i,Rais.consultarTrabalhadoresOk,n,!0);break;case COD_SERVICO.SRV_BOS:i={nomePessoa:c.arg},genericRequest(Bos.Proxy.getPessoas,i,Bos.consultarPessoasOk,n,!0)}break;case"TYPE_CPF":switch(c.service){case COD_SERVICO.SRV_PESSOAFISICA:i={cpf:c.arg},genericRequest(PessoaFisicaProxy.getPessoaFisica,i,consultarPessoaFisicaOk,n);break;case COD_SERVICO.SRV_PESSOAJURIDICA:i={cpf:c.arg,registroInicial:1,registroFinal:10},genericRequest(PessoaJuridicaProxy.getPessoaJuridicaPorCpf,i,PessoaJuridica.consultarListaOk,n,!0);break;case COD_SERVICO.SRV_ARMAS:i={cpf:c.arg},genericRequest(ArmasProxy.getArmasPorCPF,i,Armas.consultarArmaOk,n);break;case COD_SERVICO.SRV_MANDADOS:i={documentoPessoa:{identificacao:c.arg,tipoDocumento:"CPF"}},genericRequest(MandadosProxy.getMandados,i,Mandados.consultarLista,n,!0);break;case COD_SERVICO.SRV_CONDUTORES:i={cpfCondutor:c.arg},genericRequest(CondutoresProxy.getCondutoresPorCpf,i,Condutores.consultarCondutoresOk,n,!0);break;case COD_SERVICO.SRV_VEICULOS:i={cpf:c.arg},genericRequest(VeiculosProxy.getVeiculoPorProprietario,i,Veiculos.listar,n,!0);break;case COD_SERVICO.SRV_RAIS_TRAB:i={cpf:c.arg},genericRequest(RaisProxy.getTrabalhadores,i,Rais.consultarTrabalhadoresOk,n,!0);break;case COD_SERVICO.SRV_BOS:i={cpf:c.arg},genericRequest(Bos.Proxy.getPessoas,i,Bos.consultarPessoasOk,n,!0)}break;case"TYPE_PROCESSO":i={numeroProcesso:c.arg,registroInicial:1,registroFinal:10},genericRequest(MandadosProxy.getMandados,i,Mandados.consultarLista,n,!0);break;case"TYPE_MANDADO":i={numeroMandado:c.arg},genericRequest(MandadosProxy.getMandado,i,Mandados.consultar,n);break;case"TYPE_SINARM":i={sinarm:c.arg},genericRequest(ArmasProxy.getArmasPorSINARM,i,Armas.consultarArmaOk,n);break;case"TYPE_CNPJ":switch(c.service){case COD_SERVICO.SRV_ARMAS:i={cnpj:c.arg},genericRequest(ArmasProxy.getArmasPorCNPJ,i,Armas.consultarArmaOk,n);break;case COD_SERVICO.SRV_PESSOAJURIDICA:i={cnpj:c.arg},genericRequest(PessoaJuridicaProxy.getPessoaJuridica,i,PessoaJuridica.consultarOk,n);break;case COD_SERVICO.SRV_VEICULOS:i={cnpj:c.arg},genericRequest(VeiculosProxy.getVeiculoPorProprietario,i,Veiculos.listar,n,!0);break;case COD_SERVICO.SRV_RAIS_ESTAB:i={cnpjCei:c.arg},genericRequest(RaisProxy.getEstabelecimentos,i,Rais.consultarEstabelecimentosOk,n,!0)}break;case"TYPE_RENACH":i={numeroRenach:c.arg},genericRequest(CondutoresProxy.getCondutoresPorRENACH,i,Condutores.consultarCondutoresOk,n,!0);break;case"TYPE_EMPRESA":switch(c.service){case COD_SERVICO.SRV_PESSOAJURIDICA:i={nomeEmpresarial:c.arg,registroInicial:1,registroFinal:10},genericRequest(PessoaJuridicaProxy.getListaPessoaJuridica,i,PessoaJuridica.consultarListaOk,n,!0);break;case COD_SERVICO.SRV_RAIS_ESTAB:i={razaoSocial:c.arg,registroInicial:1,registroFinal:10},c.quoted&&(i.tipoPesquisa="EXATA"),genericRequest(RaisProxy.getEstabelecimentos,i,Rais.consultarEstabelecimentosOk,n,!0)}break;case"TYPE_MAE":switch(c.service){case COD_SERVICO.SRV_PESSOAFISICA:i={nomeMae:c.arg,registroInicial:1,registroFinal:10},c.quoted&&(i.tipoPesquisa="EXATA"),genericRequest(PessoaFisicaProxy.getListaPessoaFisica,i,consultarListaPessoaFisicaOk,n,!0);break;case COD_SERVICO.SRV_MANDADOS:i={nomeMae:c.arg,registroInicial:1,registroFinal:10},c.quoted&&(i.pesquisaExata=!0),genericRequest(MandadosProxy.getMandados,i,Mandados.consultarLista,n,!0);break;case COD_SERVICO.SRV_INDICE_NACIONAL:i={nomeMae:c.arg,indice:0,tamanhoPagina:10},c.quoted&&(i.consultaExata="true"),genericRequest(IndividuosProxy.getIndividuos,i,Individuos.consultarIndividuosOk,n,!0);break;case COD_SERVICO.SRV_DESAPARECIDOS:i={registroInicial:1,registroFinal:10},c.quoted?i.nomeMae=c.arg:i.nomeMaeFonetico=c.arg,genericRequest(DesaparecidosProxy.getDesaparecidos,i,Desaparecidos.consultarDesaparecidosOk,n,!0);break;case COD_SERVICO.SRV_SIAPEN:i={nomeMae:c.arg,registroInicial:1,registroFinal:10},c.quoted&&(i.tipoPesquisa="EXATA"),genericRequest(SiapenProxy.getInternos,i,Siapen.consultarInternosOk,n,!0);break;case COD_SERVICO.SRV_BOS:i={nomeMae:c.arg},genericRequest(Bos.Proxy.getPessoas,i,Bos.consultarPessoasOk,n,!0)}break;case"TYPE_PAI":switch(c.service){case COD_SERVICO.SRV_INDICE_NACIONAL:i={nomePai:c.arg,indice:0,tamanhoPagina:10},c.quoted&&(i.consultaExata="true"),genericRequest(IndividuosProxy.getIndividuos,i,Individuos.consultarIndividuosOk,n,!0);break;case COD_SERVICO.SRV_SIAPEN:i={nomePai:c.arg,registroInicial:1,registroFinal:10},c.quoted&&(i.tipoPesquisa="EXATA"),genericRequest(SiapenProxy.getInternos,i,Siapen.consultarInternosOk,n,!0);break;case COD_SERVICO.SRV_DESAPARECIDOS:i={registroInicial:1,registroFinal:10},c.quoted?i.nomePai=c.arg:i.nomePaiFonetico=c.arg,genericRequest(DesaparecidosProxy.getDesaparecidos,i,Desaparecidos.consultarDesaparecidosOk,n,!0)}break;case"TYPE_DATA":switch(c.service){case COD_SERVICO.SRV_PESSOAFISICA:i={dataNascimento:c.arg,tipoPesquisa:"EXATA",registroInicial:1,registroFinal:10},genericRequest(PessoaFisicaProxy.getListaPessoaFisica,i,consultarListaPessoaFisicaOk,n,!0);break;case COD_SERVICO.SRV_INDICE_NACIONAL:i={dataNascimento:c.arg,consultaExata:"true",indice:0,tamanhoPagina:10},genericRequest(IndividuosProxy.getIndividuos,i,Individuos.consultarIndividuosOk,n,!0);break;case COD_SERVICO.SRV_DESAPARECIDOS:i={dataNascimento:c.arg,registroInicial:1,registroFinal:10},genericRequest(DesaparecidosProxy.getDesaparecidos,i,Desaparecidos.consultarDesaparecidosOk,n,!0)}}}}}function requestFail(e,a,s,r,o,i){var n,t="alert-danger";switch(e.status){case 403:n=null!=e.responseJSON&&null!=e.responseJSON.segundo_fator_url&&""!==e.responseJSON.segundo_fator_url?(t="alert-info",'ATENÇÃO: Para habilitar a consulta a esta informação é necessário o segundo fator de autenticação. <a href="'+e.responseJSON.segundo_fator_url+'" style="text-decoration: underline;">Clique aqui para acessar.</a>'):"Usuário sem permissão de acesso à funcionalidade.";break;case 401:n="Sessão não autenticada. Realize novo login.";break;case 500:if(null!=e.responseJSON){if(null!=e.responseJSON.msgRetorno&&""!==e.responseJSON.msgRetorno){n=e.responseJSON.msgRetorno;break}if(null!=e.responseJSON.message&&""!==e.responseJSON.message){n=e.responseJSON.message;break}}default:n="Erro interno. (Status "+e.status+")"}null!=r&&(r=r.replace(/#/g,"\\#")),void 0!==i?i(e,a,s,r,n):"global-message"===r?Funcoes.globalMessageError(n):$("#"+r).append('<div style="margin-left: 15px;" class="alert '+t+'">'+n+"<span aria-hidden='true' class='glyphicon glyphicon-remove'></span></div>").show()}function genericRequest(r,e,o,a,s,i){r(e,a,s).done(function(e,a,s){Funcoes.hideStatus(),o(e,a,s,this.divres,this.param,this.fReq,r)}).fail(function(e,a,s){Funcoes.hideStatus(),requestFail(e,a,s,this.divres,this.url,i)})}var Search={serviceGroups:[],showTypes:function(e){var s="";$(e.result).each(function(e,a){s+=linhaResult("3","Serviço",a.service,"","3","Tipo do Parâmetro",a.type,"","3","Parâmetro",a.arg,"","3","Entre Aspas",a.quoted,"")}),$("#result").append(s).show(),$("#resultTabs").show()},showResult:function(e){var a="";0<e.payload.paramsComMensagem.length&&(e.payload.paramsComMensagem.forEach(function(e){a=a+"<p>"+e.valor+"</p>"}),Funcoes.globalMessageError(a)),$("#result").empty(),searchConfig.showTypes&&Search.showTypes(e.payload)},updateAddressBar:function(e){var a;a=$(location).attr("pathname")+"?q="+encodeURIComponent(e),window.history.pushState(null,""+e,a)},isUndefinedKey:function(e,a){var s=Array.isArray(a)?a:a.split("."),r=s[0]in e,o=void 0!==e[s[0]];return!r||!o||1<s.length&&Search.isUndefinedKey(e[s[0]],s.slice(1))},searchOk:function(e,a,s){switch(s.status){case 200:try{!1===e.success?Funcoes.globalMessageError(e.msgRetorno):(Search.showResult(e),searchConfig.doSearch&&consultarServicos(e.payload))}catch(e){Funcoes.globalMessageError("Erro: "+e.message)}}},searchFailed:function(e,a,s){requestFail(e,a,s,"global-message")},consultarAgrupamentoServicosFail:function(){Funcoes.globalMessageError("Falha na consulta a bases disponíveis. Favor recarregar a página.")},consultarAgrupamentoServicosOk:function(e){Funcoes.criarSelecaoDeServicos(e),Search.serviceGroups=e.agrupamentos,Funcoes.hideStatus()},confirmarVisualizacaoNotificacao:function(){SearchProxy.visualizarNotificacao().done(Search.confirmarVisualizacaoNotificacaoOk).fail(Search.confirmarVisualizacaoNotificacaoFail)},confirmarVisualizacaoNotificacaoFail:function(){Funcoes.globalMessageError("Falha na confirmação de visualização da notificação.")},confirmarVisualizacaoNotificacaoOk:function(e){!0===e.success&&Funcoes.setNewsNotification(!1)},init:function(){var e=getUrlParameterByName("q");if(searchConfig.showTypes=setProperty(searchConfig.showTypes,getUrlParameterByName("showTypes")),searchConfig.doSearch=setProperty(searchConfig.doSearch,getUrlParameterByName("doSearch")),searchConfig.debug=setProperty(searchConfig.debug,getUrlParameterByName("debug")),$("#q").val(e),e){var a=Funcoes.obterServicosSelecionados();$("#result").empty().hide(),SearchProxy.buscar(e,a).done(Search.searchOk).fail(Search.searchFailed)}$("#q").on("change",function(){$(this).parent().removeClass("has-error has-success"),$(".text-danger").parent().removeClass("has-error"),$(".text-danger").hide()}),$("#q").on("blur",function(){$(this).parent().hasClass("has-error")&&$(this).focus()}),$("#help").on("click",function(){$("#help-message").toggle()}),$("#frm-search").submit(function(e){Funcoes.globalMessageClean(),$(".control-label").parent().removeClass("has-success"),$(".text-danger").parent().removeClass("has-error"),$(".text-danger").hide(),$("#result").empty().hide(),$("#cnt-tabs").empty(),e.preventDefault();var a=$("#q").val();if(""!==a){var s=Funcoes.obterServicosSelecionados();null!=s&&0<s.length?(Search.updateAddressBar(a),SearchProxy.buscar(a,s).done(Search.searchOk).fail(Search.searchFailed)):Funcoes.globalMessageError("Nenhuma base selecionada para a pesquisa.")}else Funcoes.globalMessageError("Favor preencher o argumento de pesquisa.")}),Funcoes.showStatus("Buscando configuração de serviços"),SearchProxy.getAgrupamentos().done(Search.consultarAgrupamentoServicosOk).fail(Search.consultarAgrupamentoServicosFail);var s=getUrlParameterByName("goto");"Relatorio"===s?Report.showReport():"Sobre"===s&&Funcoes.showSobre()}};